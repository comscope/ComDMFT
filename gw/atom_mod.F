      module atom_mod
	integer :: limlb,
     &	         limlb1,
     &           limlpb,
     &           max_bs,
     &           max_e_pb,
     &           max_rl,
     &           maxb,
     &           maxel,
     &           maxel_loc,
     &           maxel0_loc,
     &           maxl_cor,
     &           maxlfpb,
     &           maxlfun,
     &           maxmt,
     &           maxmtb,
     &           maxmtcor,
     &           maxnrad,
     &           maxntle,
     &           maxpb,
     &           maxpbr,
     &           maxqmt,
     &           maxtfun,
     &           maxwf,
     &           n_ci_num,
     &           n_e_augm_max,
     &           n_pbmt,
     &           n_pbmtm,
     &           n_pbtot,
     &           ncormax,
     &           ncormmax,
     &           ncor_tot,
     &           nlb,
     &           nlb2,
     &           nlb20,
     &           nlcloc,
     &           nfun,
     &           nfun0,
     &           nrmax,
     &           nwp_full,
     &           nwp2_full,
     &           nwpmax
      real*8 :: a_const_ci
	character*1, allocatable :: correlated(:,:,:)
	character*3, allocatable :: augm(:,:,:)
	character*4, allocatable :: txtel(:)
	integer, allocatable :: i_num(:),
     & 	                      idmd(:,:,:),
     &	                      ie_isz(:,:),
     &                        ie_val(:,:),
     &                        in_val(:,:),
     &                        ind_ci(:),
     &                        ind_mm(:),
     &                        ind_pair(:,:),
     &                        ind_pb(:,:),
     &                        ind_prod(:,:,:),
     &                        ind_prod0(:,:,:),
     &                        ind_wf(:,:),
     &                        ind_y_apw(:,:,:),
     &                        indfun0(:,:,:,:),
     &                        indfun0_atom(:,:),
     &                        indmt(:,:,:),
     &                        indmtb(:,:),
     &                        indbasa(:,:,:,:),
     &                        indcor(:,:,:),
     &                        indcor0(:,:,:),
     &                        indcore(:,:,:),
     &                        io_cor(:),
     &                        io_lem(:),
     &                        io_lem0(:),
     &                        iob(:),
     &                        iob2(:),
     &                        iob20(:),
     &                        iopb(:),
     &                        iopb0(:),
     &                        konfig(:,:),
     &                        lc_max(:),
     &                        lf_cor(:,:),
     &                        lf_isz(:,:),
     &                        lf_loc(:,:),
     &                        lf_pb(:,:),
     &                        lfun(:),
     &                        lfun_pb(:),
     &                        lfunm(:),
     &                        li_cor(:,:),
     &                        li_val(:,:),
     &                        lim_pb_mt(:,:),
     &                        lm_cor(:,:),
     &                        lm_general(:,:),
     &                        lm_isz(:,:),
     &                        lm_num(:),
     &                        lm_pbmt(:,:),
     &	                      lmb(:),
     &                        lmpb(:),
     &                        lval_pb(:,:),
     &                        n_e_apw(:,:),
     &                        n_e_augm_func(:,:),
     &                        n_e_mto(:,:,:),
     &                        n_pbmt0(:),
     &                        ncor(:),
     &                        ncorm(:),
     &                        nlctot(:),
     &                        nod_cor(:,:),
     &                        nr(:),
     &                        nrad(:),
     &                        ntle(:,:),
     &                        ntle_cor(:,:),
     &                        ntle_pb(:,:),
     &                        nwpw(:)
      real*8, allocatable :: augm_coef(:,:,:,:),
     &                       b_mt(:),
     &                       amass(:),
     &	                     atoc(:,:,:),
     &                       cor_norm(:,:,:),
     &                       d_lll(:,:,:),
     &                       dbl_int(:,:,:,:,:),
     &                       dfi(:,:,:,:),
     &                       dfidot(:,:,:,:),
     &                       dfidot2(:,:,:,:),
     &                       dfun_pb(:,:),
     &                       dkin_k_smooth(:,:,:,:),
     &                       dny(:,:,:,:),
     &                       dp_k_smooth(:,:,:,:),
     &                       dr(:,:),
     &                       dr_atom(:),
     &                       drocor(:,:,:,:),
     &                       e_atm(:,:,:,:),
     &                       e_core(:,:,:),
     &                       elda_atom(:,:,:),
     &                       eny(:,:,:,:),
     &                       ex_atom(:,:,:),
     &                       ex_cc(:),
     &                       ex_cv(:),
     &                       expf_at(:,:,:,:),
     &                       f_mt_ex(:,:,:,:,:),
     &                       f_mt_exq(:,:,:,:,:),
     &                       ff_old_new(:,:,:,:,:,:,:),
     &                       ffhmt(:,:,:,:,:,:,:),
     &                       ffsmt(:,:,:,:,:,:,:),
     &                       fi(:,:,:,:),
     &                       fi0(:,:,:,:,:,:),
     &                       fidot(:,:,:,:),
     &                       fidot2(:,:,:,:),
     &                       fun_pb(:),
     &                       g_beta_atom(:,:,:,:),
     &                       g_tau_atom(:,:,:,:,:,:),
     &                       gc_beta_atom(:,:,:,:),
     &                       gc_tau_atom(:,:,:,:,:,:),
     &                       gfun(:,:),
     &                       gfund(:,:),
     &                       gfun_old(:,:),
     &                       gfund_old(:,:),
     &                       gtl_norm(:,:,:),
     &                       gx_beta_atom(:,:,:),
     &                       gx_tau_atom(:,:,:,:,:),
     &                       h(:),
     &                       ham0_mt(:,:,:,:),
     &                       lll_at(:,:,:),
     &                       lpb_fpb(:,:,:,:),
     &                       multipoles_smooth(:,:),
     &                       multipoles_true(:,:),
     &                       ovrl_mt(:,:,:,:),
     &                       ovrl_smooth(:,:,:,:),
     &                       p_f(:,:,:,:,:),
     &                       p_k_smooth(:,:,:,:),
     &                       p_nu_atom(:,:,:,:),
     &                       p_tau_atom(:,:,:,:),
     &                       pb_atom_vv(:,:,:),
     &                       pcor(:),
     &                       pcor_atom(:,:,:),
     &                       pcor_old(:),
     &                       pd_f(:,:,:,:,:),
     &                       pd2_f(:,:,:,:,:),
     &                       pref_at(:,:,:,:),
     &                       psi_nre(:,:,:),
     &                       ptnl(:,:,:,:),
     &                       pval_atom(:,:,:),
     &                       q_f(:,:,:,:,:),
     &                       qcor(:),
     &                       qcor_atom(:,:,:),
     &                       qcor_old(:),
     &                       qd_f(:,:,:,:,:),
     &                       qd2_f(:,:,:,:,:),
     &                       qval_atom(:,:,:),
     &                       r(:,:),
     &                       r_atom(:,:),
     &                       r_nre_core(:,:,:),
     &	                     r_smooth(:),
     &                       rl(:,:,:),
     &                       rl_atom(:,:),
     &                       ro(:),
     &                       ro_atom(:,:),
     &                       ro_atom_old(:),
     &                       ro_core(:,:,:),
     &                       sigc_tau_atom(:,:,:,:,:,:),
     &                       sigc_tau_atom_old(:,:,:,:,:,:),
     &                       sigx_at(:,:,:,:),
     &                       sigx_at_old(:,:,:,:),
     &	                     smt(:),
     &                       spmt(:),
     &                       t_m(:,:,:,:,:),
     &                       t_ro(:,:,:,:,:),
     &                       t_x(:,:,:),
     &                       t1_x(:,:,:,:),
     &                       tmm_pb(:,:,:,:),
     &                       v_at(:,:,:),
     &                       v_h_at(:,:,:,:),
     &                       v_h_at_lda(:,:,:,:),
     &                       v_h_at_old(:,:,:,:),
     &                       v_mt_h(:),
     &                       v_mt_h_old(:),
     &                       v_mt_xc(:),
     &                       v_xc_at(:,:,:,:),
     &                       v4_atom(:,:,:,:,:),
     &                       vhr(:),
     &                       vxc0(:),
     &                       vxc1(:),
     &                       w_at(:,:,:,:,:,:),
     &                       w_nu_atom(:,:,:,:),
     &                       w_tau_atom(:,:,:,:),
     &                       w4_nu_atom(:,:,:,:,:,:),
     &                       w4_tau_atom(:,:,:,:,:,:),
     &                       weight(:,:),
     &	                     x_atom(:,:,:,:),
     &	                     xq_atom(:,:,:,:),
     &	                     z(:),
     &	                     z_dop(:),
     &                       zcor(:)
	complex*16, allocatable :: g_omega_atom(:,:,:,:,:),
     &	                         gc_omega_atom(:,:,:,:,:),
     &	                         gx_omega_atom(:,:,:,:),
     &                           orb_mom_real(:,:,:,:),
     &	                         p_loc_tau(:,:,:,:),
     &                           sigc_omega_atom(:,:,:,:,:)
      end